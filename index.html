<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Manual Zoom Viewer</title>
<style>
  body {
    background: #111;
    color: #eee;
    font-family: sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0;
    height: 100vh;
    overflow: hidden;
  }
  #container {
    position: relative;
    width: 600px;
    height: 600px;
    overflow: hidden;
    border: 1px solid #333;
  }
  img {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    object-fit: cover;
    transform-origin: center center;
    transition: transform 0.1s linear, opacity 0.3s ease;
  }
  .hidden { opacity: 0; pointer-events: none; }
  #outline {
    position: absolute;
    border: 2px solid #00ff88;
    box-shadow: 0 0 6px #00ff88;
    transform-origin: center center;
    pointer-events: none;
    transition: transform 0.1s linear;
  }
  #caption {
    margin-top: 10px;
    text-align: center;
    width: 600px;
  }
</style>
</head>
<body>

<div id="container">
  <img id="img1" src="img1.png" alt="">
  <img id="img2" src="img2.png" class="hidden" alt="">
  <img id="img3" src="img3.png" class="hidden" alt="">
  <img id="img4" src="img4.png" class="hidden" alt="">
  <img id="img5" src="img5.png" class="hidden" alt="">
  <img id="img6" src="img6.png" class="hidden" alt="">
  <img id="img7" src="img7.png" class="hidden" alt="">

  <div id="outline"></div>
</div>
<div id="caption">Description for Image 1</div>
<p style="opacity:0.6;">⬆ Zoom In &nbsp;&nbsp; ⬇ Zoom Out</p>

<script>
const images = [
  {id: 'img1', caption: 'Description for Image 1', nextRect: [0.3, 0.3, 0.4, 0.4]}, // x,y,w,h in relative units
  {id: 'img2', caption: 'Description for Image 2', nextRect: [0.1, 0.1, 0.2, 0.3]}, // no further zoom
  {id: 'img3', caption: 'Description for Image 3', nextRect: [0.3, 0.3, 0.4, 0.4]}, // x,y,w,h in relative units
  {id: 'img4', caption: 'Description for Image 4', nextRect: [0.3, 0.3, 0.4, 0.4]}, // no further zoom
  {id: 'img5', caption: 'Description for Image 5', nextRect: [0.3, 0.3, 0.4, 0.4]}, // x,y,w,h in relative units
  {id: 'img6', caption: 'Description for Image 6', nextRect: [0.3, 0.3, 0.4, 0.4]}, // no further zoom
  {id: 'img7', caption: 'Description for Image 7', nextRect: null} // x,y,w,h in relative units
];

let current = 0;
let scale = 1;
const zoomStep = 0.05;
const minScale = 1;
const maxScale = 2;

const outline = document.getElementById('outline');
const caption = document.getElementById('caption');

function setOutline(rect) {
  if (!rect) { outline.style.display = 'none'; return; }
  outline.style.display = 'block';
  outline.style.left = (rect[0]*100) + '%';
  outline.style.top = (rect[1]*100) + '%';
  outline.style.width = (rect[2]*100) + '%';
  outline.style.height = (rect[3]*100) + '%';
}

function updateZoom() {
  const img = document.getElementById(images[current].id);

  const rect = images[current].nextRect;
  if (rect) {
    // rect = [x, y, w, h] in fractions of image size
    const cx = rect[0] + rect[2] / 2;
    const cy = rect[1] + rect[3] / 2;
    img.style.transformOrigin = `${cx * 100}% ${cy * 100}%`;
    outline.style.transformOrigin = `${cx * 100}% ${cy * 100}%`;
  } else {
    img.style.transformOrigin = "center center";
    outline.style.transformOrigin = "center center";
  }

  img.style.transform = `scale(${scale})`;
  outline.style.transform = `scale(${scale})`;
}


function swapImage(forward) {
  const oldImg = document.getElementById(images[current].id);
  oldImg.classList.add('hidden');

  current += forward ? 1 : -1;
  if (current < 0) current = 0;
  if (current >= images.length) current = images.length - 1;

  const newImg = document.getElementById(images[current].id);
  newImg.classList.remove('hidden');
  caption.textContent = images[current].caption;
  setOutline(images[current].nextRect);

  // Continuous zoom handling
  if (forward) {
    // When zooming in, start new image at normal scale
    scale = 1;
  } else {
    // When zooming out, start previous image at max zoom so it feels continuous
    scale = maxScale;
  }

  updateZoom();
}


// Keyboard controls
document.addEventListener('keydown', e => {
  if (e.key === 'ArrowUp') {
    scale += zoomStep;
    if (scale >= maxScale) {
      scale = maxScale;
      if (current < images.length - 1) swapImage(true);
    }
    updateZoom();
  }
  if (e.key === 'ArrowDown') {
    scale -= zoomStep;
    if (scale <= minScale) {
	  scale = minScale
      if (current > 0) swapImage(false);
    }
    updateZoom();
  }
});

setOutline(images[0].nextRect);
updateZoom();
</script>

</body>
</html>
